<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>Template Sketch</title>
</head>

<body style="margin: 0px">
<div id="checker">

</div>

<div id="map" style="z-index: 1; position: absolute">

</div>

<image id="layer" style="z-index: 2; position: absolute;">

</image>

<script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=ny5d4sdo0e"></script>
<script type="text/javascript">


  window.onload = function () {
    const queryString = window.location.search
    const urlParams = new URLSearchParams(queryString)

    const level = parseInt(urlParams.get('level'))
    const lat = parseFloat(urlParams.get('lat'))
    const lng = parseFloat(urlParams.get('lng'))
    const type = urlParams.get('type')

    let goalWidth
    let zoomLevel
    let maptype
    let defaultLength = 500
    let dynamicWidth = defaultLength

    if (type === 'basic') {
      maptype = naver.maps.MapTypeId.NORMAL
    } else if (type === 'satellite_base') {
      maptype = naver.maps.MapTypeId.SATELLITE
    } else if (type === 'satellite') {
      maptype = naver.maps.MapTypeId.HYBRID
    }

    switch (level) {
      case 1:
        zoomLevel = 18
        goalWidth = 5000
        break
      case 2:
        zoomLevel = 17
        goalWidth = 4000
        break
      case 5:
        zoomLevel = 16
        goalWidth = 5000
        break
      case 10:
        zoomLevel = 15
        goalWidth = 5000
        break
      default:
        break
    }

    let container = document.getElementById('map')
    let options = {
      center: new naver.maps.LatLng(lat, lng),
      zoom: zoomLevel,
      draggable: false,
      zoomControl: false,
      disableDoubleClickZoom: true,
      disableDoubleTapZoom: true,
      disableTwoFingerTapZoom: true,
      scrollWheel: false,
    }

    let map = new naver.maps.Map(container, options)
    map.setMapTypeId(maptype)

    let intervalCount = 0

    let timerId = setInterval(function () {

      intervalCount++
      map.setCenter(new naver.maps.LatLng(lat, lng))
      map.autoResize()

      if (dynamicWidth <= goalWidth) {
        container.style.height = dynamicWidth + 'px'
        container.style.width = dynamicWidth + 'px'

        dynamicWidth += defaultLength
      } else if (dynamicWidth > goalWidth) {
        document.getElementById('checker').setAttribute('id', 'checker_true')
        document.getElementById('checker_true').setAttribute('neLat', map.getBounds().getNE().lat())
        document.getElementById('checker_true').setAttribute('neLng', map.getBounds().getNE().lng())
        document.getElementById('checker_true').setAttribute('swLat', map.getBounds().getSW().lat())
        document.getElementById('checker_true').setAttribute('swLng', map.getBounds().getSW().lng())

        document.getElementById('layer').style.height = goalWidth + 'px'
        document.getElementById('layer').style.width = goalWidth + 'px'
        clearInterval(timerId)
      }

      if (intervalCount >= 30) {
        document.getElementById('checker').setAttribute('id', 'checker_true')

        clearInterval(timerId)
      }

    }, 1000)

  }


</script>
</body>
</html>
